import tkinter as tk
from tkinter import messagebox
from openpyxl import Workbook
import os
from openpyxl import load_workbook


wb = Workbook()
sheet = wb.active
sheet.title = "Student name and score"


sheet['A1'] = "Name"
sheet['B1'] = "Course"
sheet['C1'] = "Grade"

row = 2 

def check():
    global row
    name = entry1.get()
    course = entry2.get()
    grade = entry3.get()

    try:
        sheet[f'A{row}'] = name
        sheet[f'B{row}'] = course
        sheet[f'C{row}'] = grade
        wb.save("Gradesssss.xlsx")  
        row += 1
        messagebox.showinfo("Success", "Your input has been saved.")
    except:
        messagebox.showerror("Error", "Error saving file. Please close it if it's open.")
        
def show_data():
    if not os.path.exists("Gradesssss.xlsx"):
        messagebox.showerror("Error", "Walang file na nahanap.")
        return

    wb = load_workbook("Gradesssss.xlsx")
    sheet = wb.active

    top = tk.Toplevel(window)
    top.title("View Data")
    top.geometry("300x200")

    for i, row in enumerate(sheet.iter_rows(values_only=True)):
        for j, val in enumerate(row):
            tk.Label(top, text=val).grid(row=i, column=j, padx=5, pady=2)

  
    entry1.delete(0, tk.END)
    entry2.delete(0, tk.END)
    entry3.delete(0, tk.END)


window = tk.Tk()
window.geometry("350x250")
window.title("Grade Checker")
window.configure(bg="#e8f5e9") 

form_frame = tk.Frame(window, bg="#e8f5e9")
form_frame.pack(pady=20)

name = tk.Label(form_frame, text="Name:", font=("Arial", 10, "bold"), width=10, anchor="w", ).grid(row=0, column=0, padx=10, pady=5)
entry1 = tk.Entry(form_frame, width=25)
entry1.grid(row=0, column=1)


course = tk.Label(form_frame, text="Course:", font=("Arial", 10, "bold"), width=10, anchor="w", ).grid(row=1, column=0, padx=10, pady=5)
entry2 = tk.Entry(form_frame, width=25)
entry2.grid(row=1, column=1)


grade = tk.Label(window, text="Grade:", font=("Arial", 10, "bold"), )
grade.pack()
entry3 = tk.Entry(window, width=30)
entry3.pack(pady=5)

btn_view = tk.Button(window, text="View Data", command=show_data)
btn_view.pack(pady=5)


cs = tk.Button(window, text="Check and Save", command=check, bg="dark green", fg="white", font=("Arial", 10, "bold"))
cs.pack(pady=15)


window.mainloop()
